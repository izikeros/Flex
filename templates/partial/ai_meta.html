{# AI/LLM Optimization Meta Tags #}
{# These help AI systems like ChatGPT, Perplexity, and Google AI understand and cite content #}

{% if article %}
{# AI-friendly summary - priority: ai-summary > tldr from content > summary #}
{% set ai_summary = article.metadata.get('ai-summary') %}
{% if not ai_summary and article.seo_leo and article.seo_leo.tldr %}
{% set ai_summary = article.seo_leo.tldr %}
{% endif %}
{% if not ai_summary %}
{% set ai_summary = article.summary|striptags|truncate(300) %}
{% endif %}
<meta name="ai:summary" content="{{ ai_summary|striptags|escape }}">

{# Topics - prefer custom topics from frontmatter, fall back to tags #}
{% set topics = article.metadata.get('topics', article.tags|list) %}
{% if topics %}
<meta name="ai:topics" content="{{ topics|join(', ') }}">
{% endif %}

{# Expertise level if specified #}
{% if article.metadata.get('expertise-level') %}
<meta name="ai:expertise" content="{{ article.metadata.get('expertise-level') }}">
{% endif %}

{# Article type for schema selection #}
{% if article.metadata.get('article-type') %}
<meta name="ai:article-type" content="{{ article.metadata.get('article-type') }}">
{% endif %}

{# Content stats - from post_stats plugin or seo_leo_enhancer #}
{% if article.stats and article.stats.wc %}
<meta name="ai:word-count" content="{{ article.stats.wc }}">
<meta name="ai:reading-time" content="{{ article.stats.read_mins }} min">
{% elif article.seo_leo and article.seo_leo.word_count %}
<meta name="ai:word-count" content="{{ article.seo_leo.word_count }}">
<meta name="ai:reading-time" content="{{ article.seo_leo.reading_time }} min">
{% endif %}

{# Category/section #}
<meta name="ai:section" content="{{ article.category.name }}">

{# Key takeaways if specified in frontmatter #}
{% if article.metadata.get('key-takeaways') %}
<meta name="ai:key-points" content="{{ article.metadata.get('key-takeaways')|join(' | ') }}">
{% endif %}

{# Canonical URL if republished from elsewhere #}
{% if article.metadata.get('canonical-url') %}
<link rel="canonical" href="{{ article.metadata.get('canonical-url') }}">
{% endif %}
{% endif %}

{# Enhanced robots directive for AI crawlers #}
{# max-snippet:-1 allows full content extraction, max-image-preview:large allows image use #}
{% if article and article.metadata.get('no-index') %}
<meta name="robots" content="noindex, nofollow">
{% else %}
<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
{% endif %}
